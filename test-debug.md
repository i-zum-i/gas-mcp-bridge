# デバッグログのテスト方法

## 環境変数を使用したデバッグログの有効化

詳細なデバッグログを出力するために、以下の環境変数を設定してください：

### MCP専用デバッグログ (推奨)
```bash
MCP_DEBUG=1 npx mcp start
```

### 一般的なデバッグログ
```bash
DEBUG=1 npx mcp start
```

### 両方有効
```bash
DEBUG=1 MCP_DEBUG=1 npx mcp start
```

## 出力されるログの種類

### サーバ起動時
- サーバの初期化プロセス
- ツールとコンフィギュレーションの読み込み状況
- 各ツールの登録プロセス

### クライアントリクエスト処理時
- **[MCP-REQ]**: クライアントからのリクエスト詳細（タイムスタンプ付き）
- **[MCP-REQ-PARAMS]**: リクエストパラメータの詳細
- **[MCP-RES]**: レスポンス送信（タイムスタンプ付き）
- **[MCP-RES-DATA]**: レスポンスデータの詳細
- **[MCP-ERR]**: エラー発生時の詳細（タイムスタンプ付き）
- **[MCP-ERR-DETAIL]**: エラーメッセージ
- **[MCP-ERR-STACK]**: スタックトレース

### GASクライアント通信時
- HTTP リクエストの詳細（URL、認証、タイムアウト設定）
- HTTP レスポンスの詳細（ステータス、ヘッダー）
- Raw レスポンステキスト
- JSON パース結果
- ネットワークエラーの詳細

## 使用例

```bash
# MCPサーバをデバッグモードで起動
MCP_DEBUG=1 npx mcp start

# 別のターミナルでクライアントからテスト
# (Claude Desktopなどのクライアントを使用)
```

## トラブルシューティング

エラーが発生した場合、ログから以下を確認してください：

1. **[MCP-REQ]** - クライアントからのリクエストが正しく受信されているか
2. **HTTP request to GAS** - GASへのHTTPリクエストが正しく送信されているか
3. **HTTP response from GAS** - GASからの応答が正常に返されているか
4. **Parsed GAS response** - JSON レスポンスが正しくパースされているか
5. **[MCP-RES]** または **[MCP-ERR]** - 最終的なレスポンスまたはエラー

これらのログを確認することで、問題がMCPサーバ側にあるのか、GAS側にあるのか、通信の問題なのかを特定できます。